# 线性判别分析

## 1 类别密度

* 已知目标是求最优分类的类别后验概率$Pr(G|X)$

* 设$f_k(x)$是$G=k$的$x$的类别密度， 也就是类别为$k$在空间中的概率；并且还已知$\pi_k$是类别$k$的先验概率有$\sum_{k=1}^K \pi_k = 1$, 则根据先验和后验公式，可以得到后验概率和类别密度的关系
  $$
  Pr(G=k|X=x)
  \\=\frac{Pr(X=x|G=k)Pr(G=k)}{\sum_{l=1}^K Pr(X=x|G=l)Pr(G=l)}
  \\=\frac{f_k(x)\pi_k}{\sum_{l=1}^K f_l(x)\pi_l}
  $$

* 由此可见，直到类别密度基本等于知道后验概率$Pr(G|X)$

## 2 线性判别分析的导出

* 假设类别密度符合高斯分布，且其协方差矩阵$\forall k \in G, \Sigma_k=\Sigma$是相同的
  $$
  f_k(x)=\frac{1}{(2\pi)^{p/2}|\Sigma_k|^{1/2}}\exp{-\frac{1}{2}(x-\mu_k)^T\Sigma_K^{-1}(x-\mu_k)}
  $$
  

* 则比较两个类别后验概率的$log-ratio$即可
  $$
  \log{\frac{Pr(G=k|X=x)}{Pr(G=l|X=x)}}
  \\ = \log{\frac{f_k(x)}{f_l(x)}}+\log{\frac{\pi_k}{\pi_l}}
  \\ = \log{\frac{\pi_k}{\pi_l}} - \frac{1}{2}((x-\mu_l)^T\Sigma^{-1}(x-\mu_l)-(x-\mu_k)^T\Sigma^{-1}(x-\mu_k))
  \\ = \log{\frac{\pi_k}{\pi_l}} - \frac{1}{2}((x^T\Sigma^{-1}x+\mu_l^T\Sigma^{-1}\mu_l -2x^T\Sigma^{-1}\mu_l)\\-(x^T\Sigma^{-1}x+\mu_k^T\Sigma^{-1}\mu_k -2x^T\Sigma^{-1}\mu_k))
  \\ = \log{\frac{\pi_k}{\pi_l}} -\frac{1}{2}(\mu_l^T\Sigma^{-1}\mu_l-\mu_k^T\Sigma^{-1}\mu_k+2x^T\Sigma^{-1}(\mu_k-\mu_l))
  \\ = \log{\frac{\pi_k}{\pi_l}} -\frac{1}{2}(\mu_l+\mu_k)^T\Sigma^{-1}(\mu_l-\mu_k)+x^T\Sigma^{-1}(\mu_k-\mu_l)
  $$

* 可以看到，分类边界是一个超平面